---
  title: "SNA Lab 2: Network Data Management & Measurement"
  subtitle: "Test"
  author: "**Dr. Shaun Kellogg**"
  institute: "LASER Institute"
  date: '`r format(Sys.time(), "%B %d, %Y")`'
  output:
    xaringan::moon_reader:
      css:
       - default
       - css/laser.css
       - css/laser-fonts.css
      lib_dir: libs                        # creates directory for libraries
      seal: false                          # false: custom title slide
      nature:
        highlightStyle: default         # highlighting syntax for code
        highlightLines: true               # true: enables code line highlighting 
        highlightLanguage: ["r"]           # languages to highlight
        countIncrementalSlides: false      # false: disables counting of incremental slides
        ratio: "16:9"                      # 4:3 for standard size,16:9
        slideNumberFormat: |
         <div class="progress-bar-container">
          <div class="progress-bar" style="width: calc(%current% / %total% * 100%);">
          </div>
         </div>
---
class: clear, title-slide, inverse, center, top, middle

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, echo=FALSE}
# then load all the relevant packages
pacman::p_load(pacman, knitr, tidyverse, readxl)
```

```{r xaringan-panelset, echo=FALSE}
xaringanExtra::use_panelset()
```

```{r xaringanExtra-clipboard, echo=FALSE}
# these allow any code snippets to be copied to the clipboard so they 
# can be pasted easily
htmltools::tagList(
  xaringanExtra::use_clipboard(
    button_text = "<i class=\"fa fa-clipboard\"></i>",
    success_text = "<i class=\"fa fa-check\" style=\"color: #90BE6D\"></i>",
  ),
  rmarkdown::html_dependency_font_awesome()
)
```
```{r xaringan-extras, echo=FALSE}
xaringanExtra::use_tile_view()

```

# `r rmarkdown::metadata$title`
----
### `r rmarkdown::metadata$author`
### `r format(Sys.time(), "%B %d, %Y")`

---
# Agenda

.pull-left[
## Part 1: Conceptual Overview
### Data Management
- Collection
- Storage 
- Quality

]

.pull-right[

## Part 2: R Code-Along
#### Network Measurement 
- Density
- Centrality
- Reciprocity
]


???

Recall that the key difference between data used in typical STEM Ed Research and data used for social network analysis is the focus on relationships between individual rather than the individual themselves. As a result, this presents some unique issues inherent in how we manage of social network data, as well as the measurements derived from this data. 

This workshop is divided into two parts. In Part I, we focus on data management, including how to collect and store network data, as well as approaches to help ensure the quality of the data we collect. In Part II, we take a quick look at a study by Alan Daly that illustrates some of these approaches, and will then learn about some basic network-level measures such as dessity, centrality, and reciprocity that are commonly used to describe our networks mathematically. 

---
# A Quick Refresher


.pull-left[
## Network Theory

1. Social relations are often more important than individual attributes.

1. Social networks affect individual beliefs, perceptions, and behaviors.

1. Relations are not static but rather occur as part of a dynamic process.

]

.pull-right[
## Network Terms
.center[
<img src="img/nodes-edges.jpeg" height="350px"/>
]

]


???

### Network Theory
Social Network Theory rests on a few key assumptions that are fairly intuitive but also supported by ample research in education: 
1. Social relations are often more important for understanding behaviors and attitudes than are such attributes related to one's background (e.g., age, gender, etc.). The complex patterns of relations among individuals, unlike their attributes, change from context to context, condition educators and students apart from their attributes, therefore offers a deeper and broader explanation for a wide range of educational opportunities and outcomes.
2. The second assumption is what motivates a wide array of network studies in education and encourages researchers to uncover the mechanisms through which relations affect actors and to identify the conditions under which these mechanisms operate in specific contexts.
3. The last assumption is that relations are not static but rather occur as part of a dynamic process. For example, a study by Atteberry & Bryk (2010) demoonstrated how the communication patterns between teachers and the their school's literacy coach affected the successful implementation of a school-level reform initiative. These relations, in turn, altered the flow of information among teachers and created further opportunities or constraints on future interactions and whether the intervention was ultimately a success.

### Network Terms

Networks are often depicted as a **sociogram**, or network graph, that consists of nodes and edges representing indiviudals, their relations, and structural properting of the entire network.  

- **Node.** Nodes are frequently referred to as actors or vertices and typically illustrated by circles, but the shape, color and size can vary depening on what the researcher wants to illustrate abotu the data. 
- **Edges.** are frequently referred to as relations or ties. The are usually depicted by lines that represent some kind of relationship between individuals and that often have arrows indicating directionality. For example, in a communication network, arrows may illustrate a reply to a discussion thread or an email sent.  

---
class: clear, inverse, middle, center

# Part 1: Network Data Management


Data Collection, Storage, Quality

---

# Data Collection

.panelset[

.panel[.panel-name[Specify Boundary]

How do you determine **who's in the network** that you will collect data about?    

- Actors occupy a specific **position** in a social structure (e.g., leaders in a district)
- Determined by participation in an **event** at specific time and place (e.g., attendees at an academic conference)
- Defined by a specific **relation** know to the research or actors themselves.


]

.panel[.panel-name[Define Ties]

.pull-left[

### Relationship & Strength
- Friendships (friend, best friend)
- Co-Author/Presenter (# of pubs)
- Assignment Partner
- Committee Members

]


.pull-right[

### Interactions & Frequency
- Online Discussion (# of replies/DMs)
- Support Seeking (how often)
- Confidential Exchanges
- Communications

]


]


.panel[.panel-name[Identify Source]

.pull-left[

### Archives
- Email Accounts
- Discussion Forums
- Social Network Platforms
- School Records 

]


.pull-right[

### Sociometric Instrument
- [Survey](https://ncsu.qualtrics.com/jfe/preview/SV_5w2Ayiu2UriAz3M?Q_CHL=preview&Q_SurveyVersionID=current) or Interview Protocol
- Nomination or Roster
- Binary or Ordinal
- Simple or Multiplex


]

]

.panel[.panel-name[Discuss]

Consider the following quesions about a network you may be interested in studying:
- What is the boundary of this network? 
- What relations within this network might be of interest to your research? 
- What attributes about actors in this network might you want to 
- How might you collect data about these actors and their relations? 

Record your response in the chat. 

]

]

???

Prior to data collection, there are a number of decisions research have to make regarding the boundary of the network, relations to capture, and means of collecting data. 

### Boundary Specification 
- Specifying answers the question: Where do you set the limits when collecting relational data when, in theory, there are no limits? I'm going to quickly run through three generic approaches to addressing this issue.
- The **positional approach** defines a set of actors that occupy a similar position in some social structure. For example, in the study we'll take a look at in a little bit, actors in the network of study consisted of school and district level leaders at a school district placed under sanction and undergoing major school reforms. 
- The **event-based approach** to specifying a network's boundary falls delineate a network's boundaries by selecting only those actors who participated in an ‚Äúevent‚Äù at a specific time and place. For example, you may be interested in observing fellow researchers participating in an academic conference or attendees at local board of education meetings. As opposed to positional approaches that focus on actors‚Äô behavior or role, the criterion for inclusion through this approach is an event rooted in time and place.
-  The **relational approach** is typically used in egocentric studies, which we don't address here, either based on a researcher's knowledge about relations among a set of actors or relies on the actors themselves to nominate additional actors for inclusion. For example, I'm currently evaluating network of agricultural research networks and we compiled a master list of the networks involved then asked the PIs about these network to identify the actors invovled, or likely to be involved in research and training collaboration between the networks.


---
# Data Storage

.panelset[


.panel[.panel-name[Node-List]

.pull-left[

Consistent with typical data storage, node-lists often include:
- **Name or ID of nodes**
- Demographic info (gender, age) 
- Socio-economic info (job, income)
- Substantative info (grades)
- **Nominated alters**

]


.pull-right[

```{r node-list, echo=FALSE, message=FALSE, warning=FALSE}
dlt1_nodes <- read_csv("data/dlt1-nodes.csv")

dlt1_nodes |>
  head() |>
  select(UID, role1, experience, region) |>
  kable()
```

]


]

.panel[.panel-name[Edge-List]

.pull-left[

Radically different than typical data storage, edge-lists include:
- **ego and an alter**
- tie strength or frequency
- edge attributes (time, event, text)

]


.pull-right[

```{r edge-list, echo=FALSE, message=FALSE, warning=FALSE}
dlt1_edges <- read_csv("data/dlt1-edges.csv")

dlt1_edges |>
  head() |>
  select(Sender, Receiver, Timestamp) |>
  kable()
```

]


]


.panel[.panel-name[Adjacency Matrix]

.pull-left[

Also radically different, an adjacency matrix includes:
- Column for each actor
- Row for each actor
- A Value indicate the presence/strength of a relation 

]


.pull-right[

```{r adjaency-matrix, echo=FALSE, message=FALSE, warning=FALSE}

year_1_collaboration <- read_excel("data/year_1_collaboration.xlsx", 
                                   col_names = FALSE)

year_1_matrix <- as.matrix(year_1_collaboration)

rownames(year_1_matrix) <- 1:43

colnames(year_1_matrix) <- 1:43

year_1_matrix[1:8, 1:8]
```

]

]

.panel[.panel-name[Discuss]

Take a look at one of the newtwork datasets located [here](https://github.com/laser-institute/network-analysis/tree/main/lab-2/data) and consider the following:
- What format is this data set stored as? 
- What are some things you notice about this dataset? 
- What questions do you have about this dataset? 

]

]

???



---
# Data Quality

.panelset[

.panel[.panel-name[Reliability]

Recall that reliability is the **extent to which an instrument yields a similar results** every time its applied to the same participant.    

- A common approaches in SNA is **Test-Retest reliability**. 
- Closer ties tend to be reported more reliably than weaker ones
- Reciprocated relations may be more trustworthy.

]


.panel[.panel-name[Validity]

While research on construct validity is slim, and participant recall is suspect, **approaches to improve instrument validity** include:   

1. Focus on more stable relations, as opposed to ones that are time specific;
1.  Limit the number of alters one can nominate;
1.  Ask respondents to try to answer what the others would say;
1.  Consider observations or archival data (e.g. logs, student records). 


.panel[.panel-name[Measurement Error]

.pull-left[ 
### Measurement Issues
1. Recall vs. Recognition 
1. Fixed- vs. Free-Choice (Quantity)
1. Ratings vs. Rankings (Intensity)
1. Missing Data

]


.pull-right[

### Possible Solutions
1. Use a roster if network size < 50
1. No consensus, consider both
1. Ranking if network size < 20
1. Avoid if possible ;) 


]

]

]

.panel[.panel-name[Discuss]

Consider the following questions about your network interest described earlier:
- What might be some threats to the quality of your data? 
- How might you address or avoid these threats? 

Record your response in the chat.  

]

]

???

Similar to data we might typically collect about individual participants in our research, the quality of relational data also depends on reliability, validity, accuracy, and measurement error.

### Reliability
- Social network researchers can rely on several common reliability measures, including interobserver reliability, internal consistency reliability, and **test‚Äìretest reliability**. The latter, however, is the most commonly used. For example, we may ask a teacher nominates all those other teachers from whom he or she seeks advice about professional matters. The retest repeats the same (or similar) request at a later time. Highly correlated responses indicate high reliability.
- One thing to note when designing a network study or data collection instrument is that closer ties tend to be reported more reliably than weaker ones. 
- Also, for self-reported ties, reciprocated ties are more trustworthy than non reciprocated. For example, one study asking college students to report whom they spend time with found that only 58% recalled spending time with each other. 

### Validity

Sadly, there has not been a lot of research on the validity of measures of network concepts. This issue is especially relevant to data collected by participant recall. For example, a research may ask students to list five classmates with whom they study, but actual observed behavior may indicate something totally different.

Ways to improve validity include: 
- Focusing on more stable relations, as opposed to ones that are time specific. For example, asking a respondent to identify who one regularly studies with as opposed to asking who one studied with this past month might be the better option.
- Limit the number of people one can nominate in order to counteract a tendency to under/overreport the number of relations one has
- Follow up on respondents‚Äô reports, or explicitly asking respondents to try to answer what the others would say as well as what they themselves think and tell respondents that some information may be confirmed with others.
- Avoid self-report data altogether. If you sources like public records, email, participation in social networking platforms, and school transcripts, you don't need to directly ask respondents to report on their network. Instead, the network is reconstructed from these records and a number of different relations can be captured. For example, using the public Facebook profiles of a set of students in the same school, it is possible to construct a network of who bullies whom, so long as you can precisely define how bullying is measured.


---
class: clear, inverse, middle, center

# part_2(R, code_along)

Network-Level Density, Centrality, and Reciprocity 

[Learning Lab Workspace](https://rstudio.cloud/spaces/140883/join?access_code=3g8mCNU2Rags4v4U_-r-8lHdF0XAQSq-1p1tkyIz)

---
# Literature Review

.panelset[

.panel[.panel-name[Context]

.pull-left[

This longitudinal case study **examines reform-related knowledge, advice, and innovation network structures** among administrators in a district under sanction for under-performance and engaging in district-wide reform efforts.
]

.pull-right[

.center[<img src="img/daly-net.jpeg" height="320px"/>]
]

]

.panel[.panel-name[Questions]

This study involves **quantifying and visualizing the ties and overall structure** of informal networks to answer the following research questions: 

1. In what ways have reform-related social networks between district and site leaders evolved **over a 2-year period**? 
2. How do district and school leaders perceive the evolution of the social networks and its **effect on the exchange of reform-related resources** within the district?
]

.panel[.panel-name[Data]
To answer RQ1, Daly and Finnigan administered **online survey consisting of network relations and demographic questions** asking participants to:
- select the administrators in the La Estasis network that they interact with for the purpose of **advise seeking, collaboration, confidential exchanges**,
- assess their relationships on a **5-point interaction scale** ranging from 1 (no interaction) to 5 (1 to 2 times a week).

]

.panel[.panel-name[Key Findings]

Ovearall, the findings from SNA and qualitative interviews indicate that over time: 
- Networks **increased the number of superficial interactions**.
- More frequent exchanges, however, remained unchanged. 
- The result was a centralized network structure.
]

]


.footnote[
Daly, A. et al. (2011). [The ebb and flow of social network ties between district leaders.](https://github.com/laser-institute/network-analysis/blob/main/lab-2/lit/daly-ebb-flow.pdf)
]

???


---
# Load Packages

.panelset[

.panel[.panel-name[Load Libraries]

Let's start by creating a new R script and loading the following packages introduced in the previous lab:          

```{r load-libraries, message=TRUE, echo=TRUE, message=FALSE}
library(readxl)
library(tidyverse)
library(tidygraph)
library(ggraph)
```


]

.panel[.panel-name[igraph üì¶]

The {igraph} <img src="img/igraph.png" height="40px"/> package and its collection of network analysis tools provide:

- pain-free implementation of graph algorithms
- fast handling of large graphs, with millions of vertices and edges

Both {tidygraph} and {ggraph} used in the previous lab depend heavily on the {igraph} package. 

]


.panel[.panel-name[Your Turn]

Load the {igraph} package.

```{r, echo=FALSE, message=FALSE}
library(igraph)
```

```{r load-igraph, echo=TRUE}
# YOUR CODE HERE


```

]

]

---

# Import Data   

.panelset[

.panel[.panel-name[Import Data]

Let's import two Excel files from the Social Network Analysis and Education companion site. year_1_collaboration.xlsx 

```{r import-data, echo=TRUE, message=FALSE}
year_1_collaboration <- read_excel("data/year_1_collaboration.xlsx", 
                                   col_names = FALSE)
```


]

.panel[.panel-name[Inspect Data]

In the corresponding line of your R script, take a look at the data file we just imported:

```{r inspect-data, echo=TRUE}
# ADD CODE BELOW
#
#

```


]

.panel[.panel-name[Discuss]

Think about the questions below and be prepared to share your response:              

1. What type of data structure is used to store this network data? 
1. What do you think the rows and columns represent? 
1. What do the values in each cell represent?

Type your response in the chat. 

]

.panel[.panel-name[Answer]

- This adjacency matrix reports on **"collaboration" ties among 43 school leaders** in year 1 of a three-year study. 

- This is **a directed valued (weighted) network** measured on five-point scale ranging from 0 to 4, with higher values indicating more frequent collaborations (1‚Äì2 times/week).
]
]

---
# Wrangle Data  

.panelset[

.panel[.panel-name[Convert Matrix]

Before we can begin analyzing our network data in R, we need to convert to a network class R object. Run the following code in your R script:

```{r wrangle-data, echo=TRUE, message=FALSE, warning=FALSE}

year_1_matrix <- as.matrix(year_1_collaboration)

rownames(year_1_matrix) <- 1:43

colnames(year_1_matrix) <- 1:43


year_1_network <- as_tbl_graph(year_1_matrix, directed = TRUE)

```


]

.panel[.panel-name[View Network]

In the corresponding line of your R script, type the name of network object we just created and run the code:

```{r view-netwok, echo=TRUE}
# ADD CODE BELOW
#
#

```


]

.panel[.panel-name[Discuss]

Think about the questions below:              

1. What size of the Year 1 collaboration network?
1. What else do you notice about this network?
1. What questions, if any, do have about this network?

Type your responses in the chat.

]


]



---

# Network Density 

.panelset[

.panel[.panel-name[Definition]

.pull-left[ In its simplest form,  network density is **the ratio of existing ties in a network to all possible ties** that could potentially exist, regardless of whether they do.
]

.pull-right[ .center[<img src="img/density.jpeg" height="150px"/>

Which of these two networks has a higher density?
]
 
]

]

.panel[.panel-name[Significance]
In education, dense networks have been associated with:   
- healthy learning communities   
- other
- other

For better or worse, **dense networks reinforce prevailing norms** and behaviors and insulate one from outside influences (Carolan, 2011). 

]

.panel[.panel-name[Implementation]
The {igraph} package has a simple `edge_density()` function for calculating network density. Let's apply to our `year_1_network`:

```{r density, echo=TRUE}
edge_density(year_1_network)
```

How would you interpret this measure?
]

.panel[.panel-name[Discuss]

.pull-left[We know there 82 edges in the Year 1 network (pictured right), but **how many possible edges** could there be?   

**Hint**: The number of all possible edges in a directed network is V(V-1) where V is the # of vertices.

<!-- How many possible edges if this were an undirected network? -->
] 

.pull-right[
```{r examine-density, strip.white=TRUE, echo=FALSE}
autograph(year_1_network) +
  theme_graph()
```
]
]
]



---

# Network Centralization 

.panelset[

.panel[.panel-name[Definition]

.pull-left[A key structural property of complete networks is the concept of centralization, or **the extent to which relations are focused on one or a small set of actors**. 
]

.pull-right[ .center[<img src="img/density.jpeg" height="150px"/>

Which of these two networks is more centralized?
]
 
]

]

.panel[.panel-name[Significance]

- A network's centralization affects the process through which resources traverse the network. 
- Central actors likely wield a disproportionate amount of influence on the network. 
- High centralization provides fewer actors with more power and control.

]

.panel[.panel-name[Implementation]

.pull-left[
The {igraph} package has a simple `edge_density()` function for calculating network density. 

Let's apply to our `year_1_network`:]

.pull-right[
```{r centrality, echo=TRUE}
centr_degree(year_1_network, mode = "all")
```

How would you interpret this measure?
]
]

.panel[.panel-name[Discuss]

.pull-left[We know there 82 edges in the Year 1 network (pictured right), but **how many possible edges** could there be?   

**Hint**: The number of all possible edges in a directed network is V(V-1) where V is the # of vertices.

<!-- How many possible edges if this were an undirect network? -->
] 

.pull-right[
```{r examine-centrality, strip.white=TRUE, echo=FALSE}
autograph(year_1_network) +
  theme_graph()
```
]
]
]

---

# Network Reciprocity 

.panelset[

.panel[.panel-name[Definition]

.pull-left[A key structural property of complete networks is the concept of centralization, or **the extent to which relations are focused on one or a small set of actors**

]

.pull-right[ .center[<img src="img/density.jpeg" height="150px"/>

Which of these two networks is more centralized?
]
 
]

]

.panel[.panel-name[Significance]
- This property is important because it reveals the direction through which resources such as help, advice, and support flow. 
- It also indicates the network's stability, as reciprocated ties tend to be more stable over time. 
- Networks with high reciprocity may be more ‚Äúequal,‚Äù while those with lower reciprocity may be more hierarchical.

]

.panel[.panel-name[Implementation]

.pull-left[
At the network-level, reciprocity is a measure of the likelihood of vertices in a directed network to be mutually linked. The {igraph} package has a simple `reciprocity()` function for calculating network density. 

Let's apply to our `year_1_network`:]

.pull-right[
```{r reciprocity, echo=TRUE}
reciprocity(year_1_network)
```

]
]

.panel[.panel-name[Discuss]

- How would you interpret this measure? 
- What does it indicate about our network? 


]
]

---
# What's Next

.pull-left[
## Readings & Discussion

- Collection
- Management  
- Quality  
]

.pull-right[
## Case Study

- Density
- Centrality 
- Reciprocity

]





---
class: clear, center

## .font130[.center[**Thank you!**]]
<br/>
.center[<img style="border-radius: 80%;" src="img/kellogg.jpeg" height="200px"/><br/>**Dr. Shaun Kellogg**<br/><mailto:sbkellog@ncsu.edu>]
